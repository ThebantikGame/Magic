<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∏–π –ö–≤–∞–¥—Ä–∞—Ç –°—É–¥—å–±—ã</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0c1445, #1a2a6c, #2a0a4a);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 80% 70%, rgba(255,255,255,0.6), transparent),
                radial-gradient(1.5px 1.5px at 50% 20%, rgba(100,200,255,0.7), transparent),
                radial-gradient(1px 1px at 10% 80%, rgba(255,100,255,0.7), transparent);
            pointer-events: none;
            z-index: -2;
        }

        h1 {
            font-size: 2.2rem;
            margin: 30px 0 20px;
            text-shadow: 0 0 10px #8a2be2, 0 0 20px #4b0082;
            letter-spacing: 1px;
            background: linear-gradient(to right, #e0b0ff, #ff69b4, #00ffff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .input-section {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 600px;
            margin-bottom: 25px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .input-label {
            font-size: 14px;
            color: #d8bfd8;
            text-shadow: 0 0 5px rgba(224, 176, 255, 0.7);
        }

        input[type="number"] {
            width: 90px;
            padding: 12px;
            text-align: center;
            border: 2px solid #8a2be2;
            background: rgba(30, 10, 50, 0.6);
            color: white;
            border-radius: 12px;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #ff69b4;
            box-shadow: 0 0 15px rgba(255, 105, 180, 0.8);
            background: rgba(40, 15, 60, 0.8);
            transform: scale(1.05);
        }

        button {
            margin: 15px 0 25px;
            padding: 12px 30px;
            font-size: 18px;
            font-weight: bold;
            background: linear-gradient(45deg, #8a2be2, #4b0082, #00ffff);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(138, 43, 226, 0.7);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            letter-spacing: 1px;
        }

        button:hover {
            transform: scale(1.05) rotate(1deg);
            box-shadow: 0 6px 25px rgba(255, 105, 180, 0.9);
        }

        button:active {
            transform: scale(0.98);
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
            margin: 0 auto 30px;
            background: rgba(10, 5, 20, 0.7);
            border: 2px solid #8a2be2;
            border-radius: 12px;
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.6);
            overflow: hidden;
        }

        td {
            border: 1px solid rgba(138, 43, 226, 0.6);
            padding: 12px;
            width: 80px;
            height: 50px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            background: rgba(30, 15, 50, 0.6);
            transition: all 0.3s ease;
            color: #e0b0ff;
        }

        td:hover {
            background: rgba(70, 30, 100, 0.8);
            transform: translateY(-2px);
            color: white;
            box-shadow: inset 0 0 10px rgba(255, 105, 180, 0.5);
        }

        .results-container {
            display: flex;
            gap: 40px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .result-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .result-box {
            width: 80px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            background: rgba(40, 10, 60, 0.8);
            border: 2px solid #ff69b4;
            border-radius: 10px;
            color: #ff69b4;
            box-shadow: 0 0 15px rgba(255, 105, 180, 0.6);
            transition: all 0.4s ease;
        }

        .result-label {
            font-size: 15px;
            color: #d8bfd8;
            text-align: center;
            max-width: 180px;
            line-height: 1.4;
            text-shadow: 0 0 5px rgba(224, 176, 255, 0.7);
        }

        .animate-number {
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.8) rotate(-5deg);
            }
            70% {
                transform: scale(1.05) rotate(2deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .hint {
            margin-top: 20px;
            font-size: 14px;
            color: #b19cd9;
            max-width: 500px;
            line-height: 1.5;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∏–π –ö–≤–∞–¥—Ä–∞—Ç –°—É–¥—å–±—ã</h1>

    <div class="input-section">
        <div class="input-group">
            <div class="input-label">–ú–µ—Å—è—Ü</div>
            <input type="number" id="month" min="1" max="12" value="5">
        </div>
        <div class="input-group">
            <div class="input-label">–î–µ–Ω—å</div>
            <input type="number" id="day" min="1" max="31" value="17">
        </div>
        <div class="input-group">
            <div class="input-label">–ì–æ–¥ (–ø–æ–ª–Ω—ã–π)</div>
            <input type="number" id="year" value="2008">
        </div>
    </div>

    <button onclick="calculate()">‚ú® –ë–∞–º –±—É–º –±–∞–±–∞—Ö ‚ú®</button>

    <table id="magicTable">
        <tr>
            <td id="cell1A">A</td>
            <td id="cell1B">B</td>
            <td id="cell1C">C</td>
            <td id="cell1Sum">A+B+C</td>
        </tr>
        <tr>
            <td id="cell2A">C‚àí2</td>
            <td id="cell2B">D+2</td>
            <td id="cell2C">A‚àí2</td>
            <td id="cell2Sum">B+2</td>
        </tr>
        <tr>
            <td id="cell3A">D+1</td>
            <td id="cell3B">C+1</td>
            <td id="cell3C">B‚àí1</td>
            <td id="cell3Sum">A‚àí1</td>
        </tr>
        <tr>
            <td id="cell4A">B+1</td>
            <td id="cell4B">A‚àí3</td>
            <td id="cell4C">D+3</td>
            <td id="cell4Sum">C‚àí1</td>
        </tr>
    </table>

    <div class="results-container">
        <div class="result-block">
            <div class="result-box" id="sBox">S</div>
            <div class="result-label" id="sLabel">1 —Å—Ç—Ä–æ–∫–∞ —Ä–∞–≤–Ω–∞ S</div>
        </div>
        <div class="result-block">
            <div class="result-box" id="xBox">X</div>
            <div class="result-label" id="xLabel">–í—Å—è —Å—É–º–º–∞ –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–∞ —Ä–∞–≤–Ω–∞ X</div>
        </div>
    </div>

    <div class="hint">
        –í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è ‚Üí –Ω–∞–∂–º–∏—Ç–µ "–ë–∞–º –±—É–º –±–∞–±–∞—Ö" ‚Üí –∏ —É–∑–Ω–∞–π—Ç–µ —á–∏—Å–ª–∞ —Å–≤–æ–µ–π —Å—É–¥—å–±—ã!
    </div>

    <script>
        function digitSumWithSign(n) {
            if (n === 0) return 0;
            const isNegative = n < 0;
            const s = String(Math.abs(n));
            let sum = 0;
            for (let i = 0; i < s.length; i++) {
                const digit = parseInt(s[i], 10);
                if (i === 0 && isNegative) {
                    sum -= digit;
                } else {
                    sum += digit;
                }
            }
            return sum;
        }

        function calculate() {
            let month = parseInt(document.getElementById('month').value);
            let day = parseInt(document.getElementById('day').value);
            let year = parseInt(document.getElementById('year').value);

            if (isNaN(month) || month < 1 || month > 12) month = 1;
            if (isNaN(day) || day < 1 || day > 31) day = 1;
            if (isNaN(year)) year = 2000;

            const C = year % 100;
            const D = month + day + year;

            // –ò—Å—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ S –∏ X
            const raw = [
                [month, day, C, D],
                [C - 2, D + 2, month - 2, day + 2],
                [D + 1, C + 1, day - 1, month - 1],
                [day + 1, month - 3, D + 3, C - 1]
            ];

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –í–°–ï 16 —è—á–µ–µ–∫
            const display = raw.map(row => row.map(val => digitSumWithSign(val)));

            const cellIds = [
                ['cell1A', 'cell1B', 'cell1C', 'cell1Sum'],
                ['cell2A', 'cell2B', 'cell2C', 'cell2Sum'],
                ['cell3A', 'cell3B', 'cell3C', 'cell3Sum'],
                ['cell4A', 'cell4B', 'cell4C', 'cell4Sum']
            ];

            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    const el = document.getElementById(cellIds[i][j]);
                    el.textContent = display[i][j];
                    el.classList.remove('animate-number');
                    void el.offsetWidth;
                    el.classList.add('animate-number');
                }
            }

            // S –∏ X ‚Äî –ø–æ –ò–°–•–û–î–ù–´–ú —á–∏—Å–ª–∞–º, –±–µ–∑ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ü–∏—Ñ—Ä
            const S = raw[0].reduce((a, b) => a + b, 0);
            const X = raw.flat().reduce((a, b) => a + b, 0);

            const sBox = document.getElementById('sBox');
            sBox.textContent = S;
            sBox.classList.remove('animate-number');
            void sBox.offsetWidth;
            sBox.classList.add('animate-number');

            const xBox = document.getElementById('xBox');
            xBox.textContent = X;
            xBox.classList.remove('animate-number');
            void xBox.offsetWidth;
            xBox.classList.add('animate-number');

            document.getElementById('sLabel').textContent = `1 —Å—Ç—Ä–æ–∫–∞ —Ä–∞–≤–Ω–∞ ${S}`;
            document.getElementById('xLabel').textContent = `–í—Å—è —Å—É–º–º–∞ –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–∞ —Ä–∞–≤–Ω–∞ ${X}`;
        }
    </script>
</body>
</html>
